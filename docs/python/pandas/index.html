<!DOCTYPE html>
<html lang="ja">

<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0"><meta property="og:title" content="Pandas" />
<meta property="og:description" content="Pandas DataFrame 提供するライブラリ Pandas User Guide 型 Series: 列の型（要素の名前付きベクター） DataFrame: Seriesを列とするテーブル データフレームのメタデータの取得 df.columns # 列名(=" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://teuder.github.io/notebook/python/pandas/" /><meta property="article:section" content="Python" />
<meta property="article:published_time" content="2020-01-17T00:00:00+00:00" />
<meta property="article:modified_time" content="2025-07-09T13:11:58+09:00" />

<title>Pandas | notebook</title>
<link rel="icon" href="/notebook/favicon.png" type="image/x-icon">


<link rel="stylesheet" href="/notebook/book.min.2771458f1d859600effb70312702cd7e488eefb7c2c5ed4c083e65b6b95e5cae.css" integrity="sha256-J3FFjx2FlgDv&#43;3AxJwLNfkiO77fCxe1MCD5ltrleXK4=">


<script defer src="/notebook/search.min.b85637df922abffca4c9b24d079033c5b72ff94b157b0404dde8e7250ec0e893.js" integrity="sha256-uFY335Iqv/ykybJNB5Azxbcv&#43;UsVewQE3ejnJQ7A6JM="></script>

<!--
Made with Book Theme
https://github.com/alex-shpak/hugo-book
-->

  
</head>

<body>
  <input type="checkbox" class="hidden" id="menu-control" />
  <main class="flex container">

    <aside class="book-menu fixed">
      <nav>
<h2 class="book-brand">
  <a href="https://teuder.github.io/notebook/"><span>notebook</span>
  </a>
</h2>


<div class="book-search">
  <input type="text" placeholder="Search" id="book-search-input" maxlength="64" />
  <div class="book-search-spinner spinner hidden"></div>
  <ul id="book-search-results"></ul>
</div>





    

  






  <ul>
  
    

  <li >
    
      

  <a href="/notebook/docs/" >
      About
  </a>


    

    




  
  <ul>
    
  </ul>
  



  </li>


  
    

  <li >
    
      

  <a href="/notebook/python/" >
      Python
  </a>


    

    




  
  <ul>
    
      
        <li>

  <a href="/notebook/python/poloars/" >
      polars
  </a>

</li>
      
    
      
        <li>

  <a href="/notebook/python/bigquery/" >
      BigQuery
  </a>

</li>
      
    
      
        <li>

  <a href="/notebook/python/environment/" >
      environment
  </a>

</li>
      
    
      
        <li>

  <a href="/notebook/python/jupyter/" >
      jupyter
  </a>

</li>
      
    
      
        <li>

  <a href="/notebook/python/pandas/"  class="active">
      Pandas
  </a>

</li>
      
    
      
        <li>

  <a href="/notebook/python/vscode/" >
      Python in VScode
  </a>

</li>
      
    
      
        <li>

  <a href="/notebook/python/anaconda/" >
      anaconda
  </a>

</li>
      
    
  </ul>
  



  </li>


  
    

  <li >
    
      

  <a href="/notebook/r/" >
      R
  </a>


    

    




  
  <ul>
    
      
        <li>

  <a href="/notebook/r/leaflet/" >
      leaflet
  </a>

</li>
      
    
      
        <li>

  <a href="/notebook/r/rhdf5/" >
      rhdf5
  </a>

</li>
      
    
      
        <li>

  <a href="/notebook/r/ggplot2/" >
      ggplot2
  </a>

</li>
      
    
      
        <li>

  <a href="/notebook/r/raster/" >
      raster
  </a>

</li>
      
    
      
        <li>

  <a href="/notebook/r/sf/" >
      sf
  </a>

</li>
      
    
      
        <li>

  <a href="/notebook/r/bigrquery/" >
      bigrquery
  </a>

</li>
      
    
      
        <li>

  <a href="/notebook/r/dplyr/" >
      dplyr
  </a>

</li>
      
    
      
        <li>

  <a href="/notebook/r/forcats/" >
      forcats
  </a>

</li>
      
    
      
        <li>

  <a href="/notebook/r/future/" >
      future
  </a>

</li>
      
    
      
        <li>

  <a href="/notebook/r/gganimate/" >
      gganimate
  </a>

</li>
      
    
      
        <li>

  <a href="/notebook/r/graph/" >
      graph
  </a>

</li>
      
    
      
        <li>

  <a href="/notebook/r/lubridate/" >
      lubridate
  </a>

</li>
      
    
      
        <li>

  <a href="/notebook/r/purrr/" >
      purrr
  </a>

</li>
      
    
      
        <li>

  <a href="/notebook/r/package_development/" >
      R Package Development
  </a>

</li>
      
    
      
        <li>

  <a href="/notebook/r/r_python/" >
      R_Python
  </a>

</li>
      
    
      
        <li>

  <a href="/notebook/r/reticulate/" >
      reticulate
  </a>

</li>
      
    
      
        <li>

  <a href="/notebook/r/rmarkdown/" >
      Rmarkdown
  </a>

</li>
      
    
      
        <li>

  <a href="/notebook/r/rpart/" >
      rpart
  </a>

</li>
      
    
      
        <li>

  <a href="/notebook/r/rstudio/" >
      RStudio
  </a>

</li>
      
    
      
        <li>

  <a href="/notebook/r/rstudio_server/" >
      Rstudio server
  </a>

</li>
      
    
      
        <li>

  <a href="/notebook/r/rvest/" >
      rvest
  </a>

</li>
      
    
      
        <li>

  <a href="/notebook/r/stars/" >
      stars
  </a>

</li>
      
    
      
        <li>

  <a href="/notebook/r/stringr/" >
      stringr
  </a>

</li>
      
    
      
        <li>

  <a href="/notebook/r/tidymodels/" >
      tidymodels
  </a>

</li>
      
    
      
        <li>

  <a href="/notebook/r/tidyr/" >
      tidyr
  </a>

</li>
      
    
      
        <li>

  <a href="/notebook/r/wk/" >
      wk
  </a>

</li>
      
    
      
        <li>

  <a href="/notebook/r/dbi/" >
      DBI
  </a>

</li>
      
    
  </ul>
  



  </li>


  
    

  <li >
    
      

  <a href="/notebook/llm/" >
      LLM: Large Language Models
  </a>


    

    




  
  <ul>
    
  </ul>
  



  </li>


  
    

  <li >
    
      

  <a href="/notebook/datascience/" >
      Data Science
  </a>


    

    




  
  <ul>
    
      
        <li>

  <a href="/notebook/datascience/bayesian_statistics/" >
      Bayesian Staistics
  </a>

</li>
      
    
  </ul>
  



  </li>


  
    

  <li >
    
      

  <a href="/notebook/gis/" >
      GIS &amp; Remote Sensing
  </a>


    

    




  
  <ul>
    
      
        <li>

  <a href="/notebook/gis/bigquerygis/" >
      BigQuery GIS
  </a>

</li>
      
    
      
        <li>

  <a href="/notebook/gis/sar/" >
      SAR
  </a>

</li>
      
    
      
        <li>

  <a href="/notebook/gis/terminology/" >
      用語
  </a>

</li>
      
    
      
        <li>

  <a href="/notebook/gis/viirs/" >
      VIIRS
  </a>

</li>
      
    
      
        <li>

  <a href="/notebook/gis/r_package/" >
      GIS関連Rパッケージ
  </a>

</li>
      
    
  </ul>
  



  </li>


  
    

  <li >
    
      

  <a href="/notebook/mac/" >
      Mac
  </a>


    

    




  
  <ul>
    
      
        <li>

  <a href="/notebook/mac/homebrew/" >
      homebrew
  </a>

</li>
      
    
  </ul>
  



  </li>


  
    

  <li >
    
      

  <a href="/notebook/maritime/" >
      Maritime
  </a>


    

    




  
  <ul>
    
      
        <li>

  <a href="/notebook/maritime/glossary/" >
      glossary
  </a>

</li>
      
    
  </ul>
  



  </li>


  
    

  <li >
    
      

  <a href="/notebook/gcp/" >
      Google Cloud Platform
  </a>


    

    




  
  <ul>
    
      
        <li>

  <a href="/notebook/gcp/bigquery_gis/" >
      BigQuery GIS
  </a>

</li>
      
    
      
        <li>

  <a href="/notebook/gcp/bigquery_bq/" >
      BigQuery: bqコマンド
  </a>

</li>
      
    
      
        <li>

  <a href="/notebook/gcp/bigquery/" >
      BigQuery: general
  </a>

</li>
      
    
      
        <li>

  <a href="/notebook/gcp/bigquery_sql/" >
      BigQuery: SQL
  </a>

</li>
      
    
  </ul>
  



  </li>


  
    

  <li >
    
      

  <a href="/notebook/miscellaneous/" >
      miscellaneous
  </a>


    

    




  
  <ul>
    
      
        <li>

  <a href="/notebook/miscellaneous/c_plus_plus/" >
      C&#43;&#43;
  </a>

</li>
      
    
      
        <li>

  <a href="/notebook/miscellaneous/english/" >
      english
  </a>

</li>
      
    
      
        <li>

  <a href="/notebook/miscellaneous/jinjia2/" >
      jinja
  </a>

</li>
      
    
      
        <li>

  <a href="/notebook/miscellaneous/jupyter/" >
      jupyter
  </a>

</li>
      
    
      
        <li>

  <a href="/notebook/miscellaneous/pc/" >
      PC
  </a>

</li>
      
    
      
        <li>

  <a href="/notebook/miscellaneous/tmux/" >
      tmux
  </a>

</li>
      
    
      
        <li>

  <a href="/notebook/miscellaneous/vscode/" >
      vscode
  </a>

</li>
      
    
      
        <li>

  <a href="/notebook/miscellaneous/windows/" >
      Windows
  </a>

</li>
      
    
      
        <li>

  <a href="/notebook/miscellaneous/wsl/" >
      wsl
  </a>

</li>
      
    
      
        <li>

  <a href="/notebook/miscellaneous/hugo/" >
      Hugo
  </a>

</li>
      
    
      
        <li>

  <a href="/notebook/miscellaneous/git/" >
      git
  </a>

</li>
      
    
  </ul>
  



  </li>


  
  </ul>











</nav>


<script>
(function() {
  var menu = document.querySelector("aside.book-menu nav");
  addEventListener("beforeunload", function(event) {
    localStorage.setItem("menu.scrollTop", menu.scrollTop);
  });
  menu.scrollTop = localStorage.getItem("menu.scrollTop");
})();
</script>

    </aside>

    <div class="book-page">
      <header class="flex align-center justify-between book-header">
  <label for="menu-control">
    <img src="/notebook/svg/menu.svg" alt="Menu" />
  </label>
  <strong>Pandas</strong>
</header>

      
<article class="markdown"><h1 id="pandas">Pandas</h1>
<p>DataFrame 提供するライブラリ</p>
<p><a href="https://pandas.pydata.org/pandas-docs/stable/user_guide/10min.html">Pandas User Guide</a></p>
<h2 id="型">型</h2>
<ul>
<li><code>Series</code>: 列の型（要素の名前付きベクター）</li>
<li><code>DataFrame</code>: Seriesを列とするテーブル</li>
</ul>
<h2 id="データフレームのメタデータの取得">データフレームのメタデータの取得</h2>
<div class="highlight"><pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#111">df</span><span style="color:#f92672">.</span><span style="color:#111">columns</span> <span style="color:#75715e"># 列名(=文字列型の列インデックス)</span>
<span style="color:#111">df</span><span style="color:#f92672">.</span><span style="color:#111">index</span>   <span style="color:#75715e"># 行インデックス</span>
<span style="color:#111">df</span><span style="color:#f92672">.</span><span style="color:#111">values</span>  <span style="color:#75715e"># データフレームの値ををNumPy配列（ndarray）として取り出す</span>
<span style="color:#111">df</span><span style="color:#f92672">.</span><span style="color:#111">dtypes</span>  <span style="color:#75715e"># 各列の型を返す</span>
</code></pre></div><h2 id="メソッドを繋げる">メソッドを繋げる</h2>
<p>DataFrameを何回も再帰代入するより、メソッドを繋いだほうが書きやすいし読みやすい。 カッコかバックスラッシュを使えばドット前に改行やスペースを入れて整形可能。</p>
<div class="highlight"><pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#111">(</span><span style="color:#111">iris</span><span style="color:#f92672">.</span><span style="color:#111">query</span><span style="color:#111">(</span><span style="color:#d88200">&#39;species != &#34;setosa&#34;&#39;</span><span style="color:#111">)</span>
     <span style="color:#f92672">.</span><span style="color:#111">filter</span><span style="color:#111">(</span><span style="color:#111">regex</span><span style="color:#f92672">=</span><span style="color:#d88200">&#39;^(?!sepal)&#39;</span><span style="color:#111">)</span>
     <span style="color:#f92672">.</span><span style="color:#111">assign</span><span style="color:#111">(</span><span style="color:#111">petal_area</span><span style="color:#f92672">=</span><span style="color:#00a8c8">lambda</span> <span style="color:#111">x</span><span style="color:#111">:</span> <span style="color:#111">x</span><span style="color:#111">[</span><span style="color:#d88200">&#39;petal_length&#39;</span><span style="color:#111">]</span> <span style="color:#f92672">*</span> <span style="color:#111">x</span><span style="color:#111">[</span><span style="color:#d88200">&#39;petal_width&#39;</span><span style="color:#111">]</span> <span style="color:#f92672">*</span> <span style="color:#ae81ff">0.5</span><span style="color:#111">)</span>
     <span style="color:#f92672">.</span><span style="color:#111">groupby</span><span style="color:#111">(</span><span style="color:#d88200">&#39;species&#39;</span><span style="color:#111">)</span>
     <span style="color:#f92672">.</span><span style="color:#111">aggregate</span><span style="color:#111">(</span><span style="color:#111">np</span><span style="color:#f92672">.</span><span style="color:#111">mean</span><span style="color:#111">)</span>
     <span style="color:#f92672">.</span><span style="color:#111">sort_values</span><span style="color:#111">([</span><span style="color:#d88200">&#39;petal_length&#39;</span><span style="color:#111">],</span> <span style="color:#111">ascending</span><span style="color:#f92672">=</span><span style="color:#00a8c8">False</span><span style="color:#111">)</span>
<span style="color:#111">)</span>
</code></pre></div><h2 id="ファイルの読み書き">ファイルの読み書き</h2>
<h3 id="読み込み">読み込み</h3>
<div class="highlight"><pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#f92672">import</span> <span style="color:#111">pandas</span> <span style="color:#00a8c8">as</span> <span style="color:#111">pd</span>

<span style="color:#75715e"># 読み込み</span>
<span style="color:#111">df</span> <span style="color:#f92672">=</span> <span style="color:#111">pd</span><span style="color:#f92672">.</span><span style="color:#111">read_excel</span><span style="color:#111">(</span><span style="color:#d88200">&#34;test.xlsx&#34;</span><span style="color:#111">,</span> <span style="color:#111">sheet_name</span><span style="color:#f92672">=</span><span style="color:#d88200">&#34;mysheet&#34;</span><span style="color:#111">,</span> <span style="color:#111">skiprows</span> <span style="color:#f92672">=</span> <span style="color:#ae81ff">1</span><span style="color:#111">)</span>
<span style="color:#75715e"># 他にもいろいろある</span>
<span style="color:#75715e"># pd.read_csv()</span>
<span style="color:#75715e"># pd.read_parquet()</span>
<span style="color:#75715e"># pd.read_feather()</span>

</code></pre></div><h3 id="書き出し">書き出し</h3>
<div class="highlight"><pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#75715e"># 書き出し</span>
<span style="color:#111">df</span><span style="color:#f92672">.</span><span style="color:#111">to_excel</span><span style="color:#111">(</span><span style="color:#111">filepath</span><span style="color:#111">,</span> <span style="color:#111">index</span><span style="color:#f92672">=</span><span style="color:#00a8c8">False</span><span style="color:#111">)</span>
<span style="color:#75715e"># df.to_csv()</span>
<span style="color:#75715e"># df.to_parquet()</span>
<span style="color:#75715e"># df.to_feather()</span>
</code></pre></div><h2 id="列の選択">列の選択</h2>
<div class="highlight"><pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">
<span style="color:#75715e"># df[]の返値はSeries</span>
<span style="color:#75715e"># 列名での列の抽出</span>
<span style="color:#111">col</span> <span style="color:#f92672">=</span> <span style="color:#111">df</span><span style="color:#f92672">.</span><span style="color:#111">loc</span><span style="color:#111">[</span><span style="color:#d88200">&#34;col1&#34;</span><span style="color:#111">]</span>

<span style="color:#75715e"># 列番号での列の抽出</span>
<span style="color:#111">col</span> <span style="color:#f92672">=</span> <span style="color:#111">df</span><span style="color:#f92672">.</span><span style="color:#111">iloc</span><span style="color:#111">[:,</span> <span style="color:#ae81ff">1</span><span style="color:#111">]</span>


<span style="color:#75715e"># df[[]]での返値はデータフレーム</span>
<span style="color:#111">df2</span> <span style="color:#f92672">=</span> <span style="color:#111">df</span><span style="color:#111">[[</span><span style="color:#d88200">&#34;col1&#34;</span><span style="color:#111">,</span> <span style="color:#d88200">&#34;col2&#34;</span><span style="color:#111">]]</span>

<span style="color:#75715e"># 複数列を抽出（特定の列番号リストで指定）</span>
<span style="color:#111">df2</span> <span style="color:#f92672">=</span> <span style="color:#111">df</span><span style="color:#f92672">.</span><span style="color:#111">iloc</span><span style="color:#111">[:,</span> <span style="color:#111">[</span><span style="color:#ae81ff">0</span><span style="color:#111">,</span> <span style="color:#ae81ff">2</span><span style="color:#111">]]</span>  <span style="color:#75715e"># A列とC列を抽出</span>

<span style="color:#75715e"># 複数列を抽出（列の範囲を指定）</span>
<span style="color:#111">df2</span> <span style="color:#f92672">=</span> <span style="color:#111">df</span><span style="color:#f92672">.</span><span style="color:#111">iloc</span><span style="color:#111">[:,</span> <span style="color:#ae81ff">0</span><span style="color:#111">:</span><span style="color:#ae81ff">5</span><span style="color:#111">]</span>  <span style="color:#75715e"># A列～D列を抽出 0:5は[0,1,2,3,4]と同義</span>

</code></pre></div><div class="highlight"><pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#75715e"># 特定の文字列を含む列を抽出</span>
<span style="color:#111">df</span><span style="color:#f92672">.</span><span style="color:#111">filter</span><span style="color:#111">(</span><span style="color:#111">like</span><span style="color:#f92672">=</span><span style="color:#d88200">&#39;得点&#39;</span><span style="color:#111">,</span> <span style="color:#111">axis</span><span style="color:#f92672">=</span><span style="color:#ae81ff">1</span><span style="color:#111">)</span>

<span style="color:#75715e"># 列名を正規表現で抽出</span>
<span style="color:#111">df</span><span style="color:#f92672">.</span><span style="color:#111">filter</span><span style="color:#111">(</span><span style="color:#111">regex</span><span style="color:#f92672">=</span><span style="color:#d88200">&#39;^点数&#39;</span><span style="color:#111">,</span> <span style="color:#111">axis</span><span style="color:#f92672">=</span><span style="color:#ae81ff">1</span><span style="color:#111">)</span>

<span style="color:#75715e"># 数値型の列だけを抽出</span>
<span style="color:#111">df</span><span style="color:#f92672">.</span><span style="color:#111">select_dtypes</span><span style="color:#111">(</span><span style="color:#111">include</span><span style="color:#f92672">=</span><span style="color:#d88200">&#39;number&#39;</span><span style="color:#111">)</span>

<span style="color:#75715e"># 文字列型の列だけを抽出</span>
<span style="color:#111">df</span><span style="color:#f92672">.</span><span style="color:#111">select_dtypes</span><span style="color:#111">(</span><span style="color:#111">include</span><span style="color:#f92672">=</span><span style="color:#d88200">&#39;object&#39;</span><span style="color:#111">)</span>

</code></pre></div><h2 id="行の選択">行の選択</h2>
<h3 id="行インデックスや行番号での指定">行インデックスや行番号での指定</h3>
<p>DataFrameの「行インデックス」と「行番号」は異なる。行番号は先頭行を0番とした連番だが、行インデックスには「文字列や数値・日付など」を自由に付けらえる。なので3番目の行の行インデックスが0であるかもしれない。</p>
<div class="highlight"><pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">
<span style="color:#75715e"># 行インデックスで行を取得</span>
<span style="color:#111">df</span><span style="color:#f92672">.</span><span style="color:#111">loc</span><span style="color:#111">[</span><span style="color:#ae81ff">1000</span><span style="color:#111">]</span> <span style="color:#75715e"># インデックスが1000の行</span>
<span style="color:#111">df</span><span style="color:#f92672">.</span><span style="color:#111">loc</span><span style="color:#111">[</span><span style="color:#d88200">&#34;A&#34;</span><span style="color:#111">]</span>  <span style="color:#75715e"># インデックスがAの行</span>

<span style="color:#75715e"># 行番号で行を取得</span>
<span style="color:#111">df</span><span style="color:#f92672">.</span><span style="color:#111">iloc</span><span style="color:#111">[</span><span style="color:#ae81ff">1000</span><span style="color:#111">]</span> <span style="color:#75715e"># 0から始まる行番号が1000番目の行</span>

<span style="color:#75715e"># 範囲指定もできる</span>
<span style="color:#111">df</span><span style="color:#f92672">.</span><span style="color:#111">loc</span><span style="color:#111">[</span><span style="color:#ae81ff">1</span><span style="color:#111">:</span><span style="color:#ae81ff">10</span><span style="color:#111">]</span>  <span style="color:#75715e"># 行インデックスが1～9</span>
<span style="color:#111">df</span><span style="color:#f92672">.</span><span style="color:#111">iloc</span><span style="color:#111">[</span><span style="color:#ae81ff">1</span><span style="color:#111">:</span><span style="color:#ae81ff">10</span><span style="color:#111">]</span> <span style="color:#75715e"># 行番号が1～9</span>


<span style="color:#75715e"># 行番号と列番号の範囲指定で部分データフレーム</span>
<span style="color:#111">df2</span> <span style="color:#f92672">=</span> <span style="color:#111">df</span><span style="color:#f92672">.</span><span style="color:#111">iloc</span><span style="color:#111">[</span><span style="color:#ae81ff">1</span><span style="color:#111">:</span><span style="color:#ae81ff">5</span><span style="color:#111">,</span> <span style="color:#ae81ff">6</span><span style="color:#111">:</span><span style="color:#ae81ff">10</span><span style="color:#111">]</span> <span style="color:#75715e"># 行番号1～4, 列番号6～9の範囲を取得</span>

<span style="color:#75715e"># 列番号の範囲指定</span>
<span style="color:#111">df2</span> <span style="color:#f92672">=</span> <span style="color:#111">df</span><span style="color:#f92672">.</span><span style="color:#111">iloc</span><span style="color:#111">[:,</span> <span style="color:#ae81ff">6</span><span style="color:#111">:</span><span style="color:#ae81ff">10</span><span style="color:#111">]</span>

<span style="color:#75715e"># 行番号の範囲指定</span>
<span style="color:#111">df2</span> <span style="color:#f92672">=</span> <span style="color:#111">df</span><span style="color:#f92672">.</span><span style="color:#111">iloc</span><span style="color:#111">[</span><span style="color:#ae81ff">1</span><span style="color:#111">:</span><span style="color:#ae81ff">5</span><span style="color:#111">,</span> <span style="color:#111">:]</span> <span style="color:#75715e"># df.iloc[1:5] と同義</span>

</code></pre></div><h3 id="先頭行末尾行の取得">先頭行、末尾行の取得</h3>
<div class="highlight"><pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#111">df</span><span style="color:#f92672">.</span><span style="color:#111">head</span><span style="color:#111">(</span><span style="color:#ae81ff">10</span><span style="color:#111">)</span>
<span style="color:#111">df</span><span style="color:#f92672">.</span><span style="color:#111">tail</span><span style="color:#111">(</span><span style="color:#ae81ff">10</span><span style="color:#111">)</span>
</code></pre></div><h3 id="特定の列の値で行を抽出">特定の列の値で行を抽出</h3>
<p>数値型の列の例</p>
<div class="highlight"><pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">
<span style="color:#75715e"># 数値がある値より大きい</span>
<span style="color:#111">ddf_high_score</span> <span style="color:#111">f2</span> <span style="color:#f92672">=</span> <span style="color:#111">df</span><span style="color:#111">[</span><span style="color:#111">df</span><span style="color:#111">[</span><span style="color:#d88200">&#39;点数&#39;</span><span style="color:#111">]</span> <span style="color:#f92672">&gt;</span> <span style="color:#ae81ff">80</span><span style="color:#111">]</span>

<span style="color:#75715e"># 数値がある値の範囲</span>
<span style="color:#111">df_age_range</span> <span style="color:#f92672">=</span> <span style="color:#111">df</span><span style="color:#111">[(</span><span style="color:#111">df</span><span style="color:#111">[</span><span style="color:#d88200">&#39;年齢&#39;</span><span style="color:#111">]</span> <span style="color:#f92672">&gt;=</span> <span style="color:#ae81ff">30</span><span style="color:#111">)</span> <span style="color:#f92672">&amp;</span> <span style="color:#111">(</span><span style="color:#111">df</span><span style="color:#111">[</span><span style="color:#d88200">&#39;年齢&#39;</span><span style="color:#111">]</span> <span style="color:#f92672">&lt;</span> <span style="color:#ae81ff">40</span><span style="color:#111">)]</span>

<span style="color:#75715e"># 数値が特定のリストに含まれる</span>
<span style="color:#111">df_selected_scores</span> <span style="color:#f92672">=</span> <span style="color:#111">df</span><span style="color:#111">[</span><span style="color:#111">df</span><span style="color:#111">[</span><span style="color:#d88200">&#39;点数&#39;</span><span style="color:#111">]</span><span style="color:#f92672">.</span><span style="color:#111">isin</span><span style="color:#111">([</span><span style="color:#ae81ff">70</span><span style="color:#111">,</span> <span style="color:#ae81ff">90</span><span style="color:#111">])]</span>

<span style="color:#75715e"># ある列に欠損値を含まない行</span>
<span style="color:#111">df_notna</span> <span style="color:#f92672">=</span> <span style="color:#111">df</span><span style="color:#111">[</span><span style="color:#111">df</span><span style="color:#111">[</span><span style="color:#d88200">&#39;年齢&#39;</span><span style="color:#111">]</span><span style="color:#f92672">.</span><span style="color:#111">notna</span><span style="color:#111">()]</span>

<span style="color:#75715e"># 特定条件に合致する行のインデックスのみを取得する場合</span>
<span style="color:#111">index_high_score</span> <span style="color:#f92672">=</span> <span style="color:#111">df</span><span style="color:#111">[</span><span style="color:#111">df</span><span style="color:#111">[</span><span style="color:#d88200">&#39;点数&#39;</span><span style="color:#111">]</span> <span style="color:#f92672">&gt;</span> <span style="color:#ae81ff">80</span><span style="color:#111">]</span><span style="color:#f92672">.</span><span style="color:#111">index</span>

</code></pre></div><p>文字列型の列の例</p>
<div class="highlight"><pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">
<span style="color:#75715e"># 特定の文字列と一致する行</span>
<span style="color:#111">df_sales</span> <span style="color:#f92672">=</span> <span style="color:#111">df</span><span style="color:#111">[</span><span style="color:#111">df</span><span style="color:#111">[</span><span style="color:#d88200">&#39;部署&#39;</span><span style="color:#111">]</span> <span style="color:#f92672">==</span> <span style="color:#d88200">&#39;営業&#39;</span><span style="color:#111">]</span>

<span style="color:#75715e"># 複数の文字列のどれかと一致する行</span>
<span style="color:#111">df_selected</span> <span style="color:#f92672">=</span> <span style="color:#111">df</span><span style="color:#111">[</span><span style="color:#111">df</span><span style="color:#111">[</span><span style="color:#d88200">&#39;部署&#39;</span><span style="color:#111">]</span><span style="color:#f92672">.</span><span style="color:#111">isin</span><span style="color:#111">([</span><span style="color:#d88200">&#39;営業&#39;</span><span style="color:#111">,</span> <span style="color:#d88200">&#39;人事&#39;</span><span style="color:#111">])]</span>

<span style="color:#75715e"># 特定の文字列を含んでいる行</span>
<span style="color:#111">df_tanaka</span> <span style="color:#f92672">=</span> <span style="color:#111">df</span><span style="color:#111">[</span><span style="color:#111">df</span><span style="color:#111">[</span><span style="color:#d88200">&#39;氏名&#39;</span><span style="color:#111">]</span><span style="color:#f92672">.</span><span style="color:#111">str</span><span style="color:#f92672">.</span><span style="color:#111">contains</span><span style="color:#111">(</span><span style="color:#d88200">&#39;田中&#39;</span><span style="color:#111">,</span> <span style="color:#111">na</span><span style="color:#f92672">=</span><span style="color:#00a8c8">False</span><span style="color:#111">)]</span>

<span style="color:#75715e"># 特定の文字列を含んでいる行（アルファベットで大文字小文字を区別しない）</span>
<span style="color:#111">df_ignore_case</span> <span style="color:#f92672">=</span> <span style="color:#111">df</span><span style="color:#111">[</span><span style="color:#111">df</span><span style="color:#111">[</span><span style="color:#d88200">&#39;name&#39;</span><span style="color:#111">]</span><span style="color:#f92672">.</span><span style="color:#111">str</span><span style="color:#f92672">.</span><span style="color:#111">contains</span><span style="color:#111">(</span><span style="color:#d88200">&#39;TARO&#39;</span><span style="color:#111">,</span> <span style="color:#111">case</span><span style="color:#f92672">=</span><span style="color:#00a8c8">False</span><span style="color:#111">,</span> <span style="color:#111">na</span><span style="color:#f92672">=</span><span style="color:#00a8c8">False</span><span style="color:#111">)]</span>

<span style="color:#75715e"># 特定の文字列を含まない行</span>
<span style="color:#111">df_not_tanaka</span> <span style="color:#f92672">=</span> <span style="color:#111">df</span><span style="color:#111">[</span><span style="color:#f92672">~</span><span style="color:#111">df</span><span style="color:#111">[</span><span style="color:#d88200">&#39;氏名&#39;</span><span style="color:#111">]</span><span style="color:#f92672">.</span><span style="color:#111">str</span><span style="color:#f92672">.</span><span style="color:#111">contains</span><span style="color:#111">(</span><span style="color:#d88200">&#39;田中&#39;</span><span style="color:#111">,</span> <span style="color:#111">na</span><span style="color:#f92672">=</span><span style="color:#00a8c8">False</span><span style="color:#111">)]</span>

<span style="color:#75715e"># 特定の文字列で始まる行</span>
<span style="color:#111">df_start_tanaka</span> <span style="color:#f92672">=</span> <span style="color:#111">df</span><span style="color:#111">[</span><span style="color:#111">df</span><span style="color:#111">[</span><span style="color:#d88200">&#39;氏名&#39;</span><span style="color:#111">]</span><span style="color:#f92672">.</span><span style="color:#111">str</span><span style="color:#f92672">.</span><span style="color:#111">startswith</span><span style="color:#111">(</span><span style="color:#d88200">&#39;田中&#39;</span><span style="color:#111">,</span> <span style="color:#111">na</span><span style="color:#f92672">=</span><span style="color:#00a8c8">False</span><span style="color:#111">)]</span>

<span style="color:#75715e"># 特定の文字列で終わる行</span>
<span style="color:#111">df_rou</span> <span style="color:#f92672">=</span> <span style="color:#111">df</span><span style="color:#111">[</span><span style="color:#111">df</span><span style="color:#111">[</span><span style="color:#d88200">&#39;氏名&#39;</span><span style="color:#111">]</span><span style="color:#f92672">.</span><span style="color:#111">str</span><span style="color:#f92672">.</span><span style="color:#111">endswith</span><span style="color:#111">(</span><span style="color:#d88200">&#39;郎&#39;</span><span style="color:#111">,</span> <span style="color:#111">na</span><span style="color:#f92672">=</span><span style="color:#00a8c8">False</span><span style="color:#111">)]</span>

</code></pre></div><h3 id="重複行の削除">重複行の削除</h3>
<div class="highlight"><pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#111">df_nodup</span> <span style="color:#f92672">=</span> <span style="color:#111">df</span><span style="color:#f92672">.</span><span style="color:#111">drop_duplicates</span><span style="color:#111">()</span>
</code></pre></div><h2 id="単一要素の取得">単一要素の取得</h2>
<div class="highlight"><pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#75715e"># fast scalar (single value) lookup</span>
<span style="color:#111">df</span><span style="color:#f92672">.</span><span style="color:#111">at</span><span style="color:#111">[</span><span style="color:#ae81ff">0</span><span style="color:#111">,</span><span style="color:#d88200">&#39;col&#39;</span><span style="color:#111">]</span> <span style="color:#75715e"># 行番号（行インデックス？）と列名での単一要素の取り出し</span>
<span style="color:#111">df</span><span style="color:#f92672">.</span><span style="color:#111">iat</span><span style="color:#111">[</span><span style="color:#ae81ff">0</span><span style="color:#111">,</span><span style="color:#ae81ff">1</span><span style="color:#111">]</span>    <span style="color:#75715e"># 行番号と列番号で単一要素の取り出し</span>

</code></pre></div><h2 id="列の加工">列の加工</h2>
<h3 id="加工列の作成">加工列の作成</h3>
<p>既存の列を加工して新しい列を追加する。</p>
<div class="highlight"><pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#75715e"># assign()とlambdaの組み合わせ</span>
<span style="color:#75715e"># xはdf全体を意味する</span>
<span style="color:#f92672">import</span> <span style="color:#111">pandas</span> <span style="color:#00a8c8">as</span> <span style="color:#111">pd</span>

<span style="color:#111">df</span> <span style="color:#f92672">=</span> <span style="color:#111">pd</span><span style="color:#f92672">.</span><span style="color:#111">DataFrame</span><span style="color:#111">({</span>
    <span style="color:#d88200">&#39;price&#39;</span><span style="color:#111">:</span> <span style="color:#111">[</span><span style="color:#ae81ff">100</span><span style="color:#111">,</span> <span style="color:#ae81ff">200</span><span style="color:#111">,</span> <span style="color:#ae81ff">300</span><span style="color:#111">],</span>
    <span style="color:#d88200">&#39;quantity&#39;</span><span style="color:#111">:</span> <span style="color:#111">[</span><span style="color:#ae81ff">1</span><span style="color:#111">,</span> <span style="color:#ae81ff">3</span><span style="color:#111">,</span> <span style="color:#ae81ff">2</span><span style="color:#111">]</span>
<span style="color:#111">})</span>

<span style="color:#75715e"># よくあるやり方</span>
<span style="color:#111">df</span><span style="color:#111">[</span><span style="color:#d88200">&#39;total&#39;</span><span style="color:#111">]</span> <span style="color:#f92672">=</span> <span style="color:#111">df</span><span style="color:#111">[</span><span style="color:#d88200">&#39;price&#39;</span><span style="color:#111">]</span> <span style="color:#f92672">+</span>  <span style="color:#111">df</span><span style="color:#111">[</span><span style="color:#d88200">&#39;quantity&#39;</span><span style="color:#111">]</span>

<span style="color:#75715e"># assign() &amp; lambdaを使った方法</span>
<span style="color:#75715e"># xはdf全体を意味する</span>
<span style="color:#111">df</span> <span style="color:#f92672">=</span> <span style="color:#111">(</span>
    <span style="color:#111">df</span>
    <span style="color:#f92672">.</span><span style="color:#111">assign</span><span style="color:#111">(</span>
        <span style="color:#111">total</span><span style="color:#f92672">=</span><span style="color:#00a8c8">lambda</span> <span style="color:#111">x</span><span style="color:#111">:</span> <span style="color:#111">x</span><span style="color:#111">[</span><span style="color:#d88200">&#39;price&#39;</span><span style="color:#111">]</span> <span style="color:#f92672">*</span> <span style="color:#111">x</span><span style="color:#111">[</span><span style="color:#d88200">&#39;quantity&#39;</span><span style="color:#111">],</span>
        <span style="color:#111">price_with_tax</span><span style="color:#f92672">=</span><span style="color:#00a8c8">lambda</span> <span style="color:#111">x</span><span style="color:#111">:</span> <span style="color:#111">x</span><span style="color:#111">[</span><span style="color:#d88200">&#39;price&#39;</span><span style="color:#111">]</span> <span style="color:#f92672">*</span> <span style="color:#ae81ff">1.10</span>
    <span style="color:#111">)</span>
<span style="color:#111">)</span>
</code></pre></div><h3 id="列名の変更rename">列名の変更.rename()</h3>
<div class="highlight"><pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#111">df_renamed</span> <span style="color:#f92672">=</span> <span style="color:#111">df</span><span style="color:#f92672">.</span><span style="color:#111">rename</span><span style="color:#111">(</span><span style="color:#111">columns</span><span style="color:#f92672">=</span><span style="color:#111">{</span>
    <span style="color:#d88200">&#39;size&#39;</span><span style="color:#111">:</span> <span style="color:#d88200">&#39;件数&#39;</span><span style="color:#111">,</span>
    <span style="color:#d88200">&#39;③成分名&#39;</span><span style="color:#111">:</span> <span style="color:#d88200">&#39;成分&#39;</span><span style="color:#111">,</span>
    <span style="color:#d88200">&#39;⑫製造販売業者の</span><span style="color:#8045ff">\n</span><span style="color:#d88200">「出荷対応」の状況&#39;</span><span style="color:#111">:</span> <span style="color:#d88200">&#39;出荷状況&#39;</span>
<span style="color:#111">})</span>
</code></pre></div><h2 id="行をソートする">行をソートする</h2>
<div class="highlight"><pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#111">df_sorted</span> <span style="color:#f92672">=</span> <span style="color:#111">df</span><span style="color:#f92672">.</span><span style="color:#111">sort_values</span><span style="color:#111">(</span>
    <span style="color:#111">by</span><span style="color:#f92672">=</span><span style="color:#111">[</span><span style="color:#d88200">&#39;列A&#39;</span><span style="color:#111">,</span> <span style="color:#d88200">&#39;列B&#39;</span><span style="color:#111">],</span>        <span style="color:#75715e"># ソート基準の列</span>
    <span style="color:#111">ascending</span><span style="color:#f92672">=</span><span style="color:#111">[</span><span style="color:#00a8c8">False</span><span style="color:#111">,</span> <span style="color:#00a8c8">False</span><span style="color:#111">]</span>  <span style="color:#75715e"># どちらも降順</span>
<span style="color:#111">)</span>
</code></pre></div><h2 id="集計">集計</h2>
<h3 id="groupby">groupby()</h3>
<div class="highlight"><pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#f92672">import</span> <span style="color:#111">pandas</span> <span style="color:#00a8c8">as</span> <span style="color:#111">pd</span>

<span style="color:#111">df</span> <span style="color:#f92672">=</span> <span style="color:#111">pd</span><span style="color:#f92672">.</span><span style="color:#111">DataFrame</span><span style="color:#111">({</span>
    <span style="color:#d88200">&#39;category&#39;</span><span style="color:#111">:</span> <span style="color:#111">[</span><span style="color:#d88200">&#39;A&#39;</span><span style="color:#111">,</span> <span style="color:#d88200">&#39;B&#39;</span><span style="color:#111">,</span> <span style="color:#d88200">&#39;A&#39;</span><span style="color:#111">,</span> <span style="color:#d88200">&#39;B&#39;</span><span style="color:#111">,</span> <span style="color:#d88200">&#39;A&#39;</span><span style="color:#111">],</span>
    <span style="color:#d88200">&#39;price&#39;</span><span style="color:#111">:</span> <span style="color:#111">[</span><span style="color:#ae81ff">100</span><span style="color:#111">,</span> <span style="color:#ae81ff">200</span><span style="color:#111">,</span> <span style="color:#ae81ff">150</span><span style="color:#111">,</span> <span style="color:#ae81ff">250</span><span style="color:#111">,</span> <span style="color:#ae81ff">120</span><span style="color:#111">],</span>
    <span style="color:#d88200">&#39;quantity&#39;</span><span style="color:#111">:</span> <span style="color:#111">[</span><span style="color:#ae81ff">1</span><span style="color:#111">,</span> <span style="color:#ae81ff">2</span><span style="color:#111">,</span> <span style="color:#ae81ff">1</span><span style="color:#111">,</span> <span style="color:#ae81ff">1</span><span style="color:#111">,</span> <span style="color:#ae81ff">3</span><span style="color:#111">]</span>
<span style="color:#111">})</span>


<span style="color:#75715e"># 2つの列でグループ化し、件数をカウント</span>
<span style="color:#111">grouped</span> <span style="color:#f92672">=</span> <span style="color:#111">df</span><span style="color:#f92672">.</span><span style="color:#111">groupby</span><span style="color:#111">([</span><span style="color:#d88200">&#39;列A&#39;</span><span style="color:#111">,</span> <span style="color:#d88200">&#39;列B&#39;</span><span style="color:#111">],</span> <span style="color:#111">as_index</span><span style="color:#f92672">=</span><span style="color:#00a8c8">False</span><span style="color:#111">)</span><span style="color:#f92672">.</span><span style="color:#111">size</span><span style="color:#111">()</span><span style="color:#f92672">.</span><span style="color:#111">reset_index</span><span style="color:#111">(</span><span style="color:#111">name</span><span style="color:#f92672">=</span><span style="color:#d88200">&#39;件数&#39;</span><span style="color:#111">)</span>


<span style="color:#75715e"># 基本はこの形で覚える</span>
<span style="color:#111">result</span> <span style="color:#f92672">=</span> <span style="color:#111">(</span>
    <span style="color:#111">df</span>
    <span style="color:#75715e"># category列の値でグループ化</span>
    <span style="color:#f92672">.</span><span style="color:#111">groupby</span><span style="color:#111">(</span><span style="color:#d88200">&#39;category&#39;</span><span style="color:#111">,</span> <span style="color:#111">as_index</span><span style="color:#f92672">=</span><span style="color:#00a8c8">False</span><span style="color:#111">)</span>
    <span style="color:#75715e"># as_index=False だと結果に category 列を含める</span>
    <span style="color:#75715e"># as_index=True  だと category の値が行インデックスになる</span>
    <span style="color:#75715e"># グループごとに集計</span>
    <span style="color:#f92672">.</span><span style="color:#111">agg</span><span style="color:#111">(</span>
        <span style="color:#75715e"># price列の meanを計算して、price_mean列を作成</span>
        <span style="color:#111">price_mean</span><span style="color:#f92672">=</span><span style="color:#111">(</span><span style="color:#d88200">&#39;price&#39;</span><span style="color:#111">,</span> <span style="color:#d88200">&#39;mean&#39;</span><span style="color:#111">),</span>
        <span style="color:#111">price_max</span><span style="color:#f92672">=</span><span style="color:#111">(</span><span style="color:#d88200">&#39;price&#39;</span><span style="color:#111">,</span> <span style="color:#d88200">&#39;max&#39;</span><span style="color:#111">),</span>
        <span style="color:#111">total_quantity</span><span style="color:#f92672">=</span><span style="color:#111">(</span><span style="color:#d88200">&#39;quantity&#39;</span><span style="color:#111">,</span> <span style="color:#d88200">&#39;sum&#39;</span><span style="color:#111">)</span>
    <span style="color:#111">)</span>
<span style="color:#111">)</span>

<span style="color:#75715e"># この形だと、結果の行(&#39;category&#39;)と列（&#39;price&#39;, &#39;quantity&#39;）にインデックスが付与される</span>
<span style="color:#111">result</span> <span style="color:#f92672">=</span> <span style="color:#111">(</span>
    <span style="color:#111">df</span>
    <span style="color:#f92672">.</span><span style="color:#111">groupby</span><span style="color:#111">(</span><span style="color:#d88200">&#39;category&#39;</span><span style="color:#111">)</span>
    <span style="color:#f92672">.</span><span style="color:#111">agg</span><span style="color:#111">({</span>
        <span style="color:#d88200">&#39;price&#39;</span><span style="color:#111">:</span> <span style="color:#d88200">&#39;sum&#39;</span><span style="color:#111">,</span>
        <span style="color:#d88200">&#39;quantity&#39;</span><span style="color:#111">:</span> <span style="color:#d88200">&#39;sum&#39;</span>
    <span style="color:#111">})</span>
<span style="color:#111">)</span>

<span style="color:#75715e"># 複数の関数を適用することもできる</span>
<span style="color:#75715e"># ただし結果が列名ではなく、マルチインデックス（入れ子になったインデックス）になるのでわかりにくい</span>
<span style="color:#111">result</span> <span style="color:#f92672">=</span> <span style="color:#111">(</span>
    <span style="color:#111">df</span>
    <span style="color:#f92672">.</span><span style="color:#111">groupby</span><span style="color:#111">(</span><span style="color:#d88200">&#39;category&#39;</span><span style="color:#111">)</span>
    <span style="color:#f92672">.</span><span style="color:#111">agg</span><span style="color:#111">({</span>
        <span style="color:#d88200">&#39;price&#39;</span><span style="color:#111">:</span> <span style="color:#111">[</span><span style="color:#d88200">&#39;mean&#39;</span><span style="color:#111">,</span> <span style="color:#d88200">&#39;sum&#39;</span><span style="color:#111">,</span> <span style="color:#d88200">&#39;max&#39;</span><span style="color:#111">],</span>
        <span style="color:#d88200">&#39;quantity&#39;</span><span style="color:#111">:</span> <span style="color:#111">[</span><span style="color:#d88200">&#39;sum&#39;</span><span style="color:#111">,</span> <span style="color:#d88200">&#39;count&#39;</span><span style="color:#111">]</span>
    <span style="color:#111">})</span>
<span style="color:#111">)</span>
</code></pre></div><table>
<thead>
<tr>
<th>関数名</th>
<th>説明</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>'sum'</code></td>
<td>合計</td>
</tr>
<tr>
<td><code>'mean'</code></td>
<td>平均</td>
</tr>
<tr>
<td><code>'median'</code></td>
<td>中央値</td>
</tr>
<tr>
<td><code>'max'</code></td>
<td>最大値</td>
</tr>
<tr>
<td><code>'min'</code></td>
<td>最小値</td>
</tr>
<tr>
<td><code>'count'</code></td>
<td>件数（NaNを除く）</td>
</tr>
<tr>
<td><code>'size'</code></td>
<td>件数（NaN含む、countとの違い）</td>
</tr>
<tr>
<td><code>'std'</code></td>
<td>標準偏差</td>
</tr>
<tr>
<td><code>'var'</code></td>
<td>分散</td>
</tr>
<tr>
<td><code>'first'</code></td>
<td>最初の値</td>
</tr>
<tr>
<td><code>'last'</code></td>
<td>最後の値</td>
</tr>
<tr>
<td><code>'nunique'</code></td>
<td>重複を除いた件数</td>
</tr>
<tr>
<td><code>'any'</code></td>
<td>真偽値でいずれかがTrue</td>
</tr>
<tr>
<td><code>'all'</code></td>
<td>真偽値で全てTrue</td>
</tr>
</tbody>
</table>
<h2 id="データフレームの結合">データフレームの結合</h2>
<h3 id="pdmerge">pd.merge</h3>
<div class="highlight"><pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#111">pd</span><span style="color:#f92672">.</span><span style="color:#111">merge</span><span style="color:#111">(</span><span style="color:#111">df1</span><span style="color:#111">,</span> <span style="color:#111">df2</span><span style="color:#111">,</span> <span style="color:#111">on</span><span style="color:#f92672">=</span><span style="color:#d88200">&#39;キー列&#39;</span><span style="color:#111">,</span> <span style="color:#111">how</span><span style="color:#f92672">=</span><span style="color:#d88200">&#39;left&#39;</span><span style="color:#111">)</span>

<span style="color:#75715e"># 複数列</span>
<span style="color:#111">pd</span><span style="color:#f92672">.</span><span style="color:#111">merge</span><span style="color:#111">(</span><span style="color:#111">df1</span><span style="color:#111">,</span> <span style="color:#111">df2</span><span style="color:#111">,</span> <span style="color:#111">on</span><span style="color:#f92672">=</span><span style="color:#111">[</span><span style="color:#d88200">&#39;成分名&#39;</span><span style="color:#111">,</span> <span style="color:#d88200">&#39;製造会社名&#39;</span><span style="color:#111">],</span> <span style="color:#111">how</span><span style="color:#f92672">=</span><span style="color:#d88200">&#39;outer&#39;</span><span style="color:#111">)</span>

<span style="color:#75715e"># キーとなる列名が異なる場合</span>
<span style="color:#111">pd</span><span style="color:#f92672">.</span><span style="color:#111">merge</span><span style="color:#111">(</span><span style="color:#111">df1</span><span style="color:#111">,</span> <span style="color:#111">df2</span><span style="color:#111">,</span> <span style="color:#111">left_on</span><span style="color:#f92672">=</span><span style="color:#d88200">&#39;df1側の列&#39;</span><span style="color:#111">,</span> <span style="color:#111">right_on</span><span style="color:#f92672">=</span><span style="color:#d88200">&#39;df2側の列&#39;</span><span style="color:#111">,</span> <span style="color:#111">how</span><span style="color:#f92672">=</span><span style="color:#d88200">&#39;inner&#39;</span><span style="color:#111">)</span>
</code></pre></div><p>how	&lsquo;inner&rsquo;, &lsquo;left&rsquo;, &lsquo;right&rsquo;, &lsquo;outer&rsquo;</p>
<h2 id="データの変形">データの変形</h2>
<p><a href="https://pandas.pydata.org/pandas-docs/stable/user_guide/reshaping.html">https://pandas.pydata.org/pandas-docs/stable/user_guide/reshaping.html</a></p>
<h3 id="縦持ち変換melt-横持ち変換pivot">縦持ち変換.melt() 横持ち変換.pivot()</h3>
<h4 id="縦持ち変換">縦持ち変換</h4>
<p><code>df.melt(id_vars=None, value_vars=None, var_name=None, value_name='value', ...)</code></p>
<p>Rでいう <code>tidyr::pivot_longer()</code>。</p>
<h4 id="横持ち変換">横持ち変換</h4>
<p><code>df.pivot(index=None, columns=None, values=None)</code></p>
<p>Rでいう <code>tidyr::pivot_wider()</code>。</p>
<h3 id="dfpivot_table">df.pivot_table()</h3>
<h2 id="インデックス">インデックス</h2>
<div class="highlight"><pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#75715e"># 指定した列を**インデックス（行ラベル）**に変換します。</span>
<span style="color:#75715e"># # inplace=Trueを指定すると元のデータフレームに対して直接変更されます。</span>
<span style="color:#111">df</span><span style="color:#f92672">.</span><span style="color:#111">set_index</span><span style="color:#111">(</span><span style="color:#d88200">&#39;列名&#39;</span><span style="color:#111">,</span> <span style="color:#111">inplace</span><span style="color:#f92672">=</span><span style="color:#00a8c8">False</span><span style="color:#111">)</span>

<span style="color:#75715e"># 現在のインデックスを通常の列として戻し、デフォルトの数値インデックスに戻します。</span>
<span style="color:#75715e"># drop=Trueを指定すると、インデックス列をデータフレームに戻さず削除します。</span>
<span style="color:#75715e"># inplace=Trueを使えば元のDataFrameを直接変更します。</span>
<span style="color:#111">df</span><span style="color:#f92672">.</span><span style="color:#111">reset_index</span><span style="color:#111">(</span><span style="color:#111">inplace</span><span style="color:#f92672">=</span><span style="color:#00a8c8">False</span><span style="color:#111">,</span> <span style="color:#111">drop</span><span style="color:#f92672">=</span><span style="color:#00a8c8">False</span><span style="color:#111">)</span>
</code></pre></div><h2 id="pandasseries">Pandas.Series</h2>
<p>名前付きベクトルのようなもの、データフレームの列や行をSeriesとして取り出すこともできる。</p>
<div class="highlight"><pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#111">s</span> <span style="color:#f92672">=</span> <span style="color:#111">pd</span><span style="color:#f92672">.</span><span style="color:#111">Series</span><span style="color:#111">([</span><span style="color:#ae81ff">1</span><span style="color:#111">,</span> <span style="color:#ae81ff">2</span><span style="color:#111">,</span> <span style="color:#ae81ff">3</span><span style="color:#111">,</span> <span style="color:#ae81ff">4</span><span style="color:#111">],</span> <span style="color:#111">index</span><span style="color:#f92672">=</span><span style="color:#111">[</span><span style="color:#d88200">&#39;a&#39;</span><span style="color:#111">,</span> <span style="color:#d88200">&#39;b&#39;</span><span style="color:#111">,</span> <span style="color:#d88200">&#39;c&#39;</span><span style="color:#111">,</span> <span style="color:#d88200">&#39;d&#39;</span><span style="color:#111">])</span>

<span style="color:#111">print</span><span style="color:#111">(</span><span style="color:#111">s</span><span style="color:#111">[</span><span style="color:#d88200">&#39;a&#39;</span><span style="color:#111">])</span>  <span style="color:#75715e"># 出力: 1</span>
<span style="color:#111">print</span><span style="color:#111">(</span><span style="color:#111">s</span><span style="color:#111">[</span><span style="color:#ae81ff">0</span><span style="color:#111">])</span>    <span style="color:#75715e"># 出力: 1</span>

<span style="color:#75715e"># 値で抽出</span>
<span style="color:#111">print</span><span style="color:#111">(</span><span style="color:#111">s</span><span style="color:#111">[</span><span style="color:#111">s</span> <span style="color:#f92672">&gt;</span> <span style="color:#ae81ff">2</span><span style="color:#111">])</span>

<span style="color:#75715e"># 計算集計</span>
<span style="color:#111">print</span><span style="color:#111">(</span><span style="color:#111">s</span><span style="color:#f92672">.</span><span style="color:#111">sum</span><span style="color:#111">())</span>  <span style="color:#75715e"># 出力: 10</span>
<span style="color:#111">print</span><span style="color:#111">(</span><span style="color:#111">s</span><span style="color:#f92672">.</span><span style="color:#111">mean</span><span style="color:#111">())</span> <span style="color:#75715e"># 出力: 2.5</span>

</code></pre></div><h2 id="bigquery-との連携">BigQuery との連携</h2>
<div class="highlight"><pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#f92672">import</span> <span style="color:#111">pandas_gbq</span>

<span style="color:#111">df</span> <span style="color:#f92672">=</span> <span style="color:#111">pandas_gbq</span><span style="color:#f92672">.</span><span style="color:#111">read_gbq</span><span style="color:#111">(</span><span style="color:#d88200">&#34;SELECT my_col FROM `my_project.my_dataset.my_table`&#34;</span><span style="color:#111">)</span>

</code></pre></div><p>初回に実行した時にブラウザが開いてアクセスコードの入力が求められる</p>
<p>ユーザーごとのアクセス情報は以下に保存される。</p>
<ul>
<li>Windows
<ul>
<li><code>%APPDATA%\pandas_gbq\bigquery_credentials.dat</code></li>
</ul>
</li>
<li>Linux/Mac/Unix
<ul>
<li><code>~/.config/pandas_gbq/bigquery_credentials.dat</code></li>
</ul>
</li>
</ul>
<p>これらのパスをLinux/Mac/Windowsの環境変数として保存しておく
<code>GOOGLE_APPLICATION_CREDENTIALS</code></p>
</article>

      
<div class="book-footer justify-between">
  
  <div>
    
    <a class="flex align-center" href="https://github.com/teuder/notebook/commit/58121a180d9f011076d215c166a880769eaf7856" title='Last modified 2025-07-09 by Masaki Tsuda' target="_blank" rel="noopener">
      <img src="/notebook/svg/calendar.svg" alt="Changed" />
      <span>2025-07-09</span>
    </a>
  </div>
  
  
  <div>
    
    <a class="flex align-center" href="https://github.com/teuder/notebook/edit/master/content/Python/pandas.md" target="_blank" rel="noopener">
      <img src="/notebook/svg/edit.svg" alt="Edit" />
      <span>Edit this page</span>
    </a>
    
  </div>
  
</div>


      
    </div>

    
  

  <aside class="book-toc level-3 fixed">
    <nav id="TableOfContents">
  <ul>
    <li><a href="#型">型</a></li>
    <li><a href="#データフレームのメタデータの取得">データフレームのメタデータの取得</a></li>
    <li><a href="#メソッドを繋げる">メソッドを繋げる</a></li>
    <li><a href="#ファイルの読み書き">ファイルの読み書き</a>
      <ul>
        <li><a href="#読み込み">読み込み</a></li>
        <li><a href="#書き出し">書き出し</a></li>
      </ul>
    </li>
    <li><a href="#列の選択">列の選択</a></li>
    <li><a href="#行の選択">行の選択</a>
      <ul>
        <li><a href="#行インデックスや行番号での指定">行インデックスや行番号での指定</a></li>
        <li><a href="#先頭行末尾行の取得">先頭行、末尾行の取得</a></li>
        <li><a href="#特定の列の値で行を抽出">特定の列の値で行を抽出</a></li>
        <li><a href="#重複行の削除">重複行の削除</a></li>
      </ul>
    </li>
    <li><a href="#単一要素の取得">単一要素の取得</a></li>
    <li><a href="#列の加工">列の加工</a>
      <ul>
        <li><a href="#加工列の作成">加工列の作成</a></li>
        <li><a href="#列名の変更rename">列名の変更.rename()</a></li>
      </ul>
    </li>
    <li><a href="#行をソートする">行をソートする</a></li>
    <li><a href="#集計">集計</a>
      <ul>
        <li><a href="#groupby">groupby()</a></li>
      </ul>
    </li>
    <li><a href="#データフレームの結合">データフレームの結合</a>
      <ul>
        <li><a href="#pdmerge">pd.merge</a></li>
      </ul>
    </li>
    <li><a href="#データの変形">データの変形</a>
      <ul>
        <li><a href="#縦持ち変換melt-横持ち変換pivot">縦持ち変換.melt() 横持ち変換.pivot()</a></li>
        <li><a href="#dfpivot_table">df.pivot_table()</a></li>
      </ul>
    </li>
    <li><a href="#インデックス">インデックス</a></li>
    <li><a href="#pandasseries">Pandas.Series</a></li>
    <li><a href="#bigquery-との連携">BigQuery との連携</a></li>
  </ul>
</nav>
  </aside>



  </main>

  
</body>

</html>
